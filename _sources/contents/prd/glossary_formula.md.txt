# 用語集・計算式

## 用語集
**立替**  
一人の個人的な出費を、もう一人が一時的に代わって支払ったことを指します。立て替えた人は、その全額を返還されなければなりません。

***

**清算額**  
月ごとに算出される額です。その月の支出額をもとに、どちらのユーザーがもう一方にいくら払えば支出が均等になるかを示します。

***

## 計算式

用語集の「精算額」を算出するための計算式は以下の通りです。清算は月ごとに行う前提とします。

まずは、ユーザー一人当たりのの支出合計を計算します。

`
(一人当たりの合計支出) = SUM(一件ごとの支出額) + (立替での支出額) * 2
`

立替での支出額は2で掛けているため、ここで算出されたユーザー当たりの支出合計は、単体で見ると意味を成しません。
理由は後述します。

算出したユーザー当たりの合計支出を比較し、多いほうから低いほうを減算し、合計支出の差額を求めます。  
差額が0だった場合は、ここで計算終了とします。

`
(差額) = (比較して多かったほうのユーザー当たりの合計支出額) - (比較して低かったほうのユーザー当たりの合計支出額)
`

ここで算出された差額から、どちらのユーザーがもう一方にいくら支払えば当月の支出が均等になるか求めます。

`
(清算額) = (差額) / 2
`

これで計算は終了です。算出された精算額を、合計支出が低かったユーザーが、合計支出の多かったユーザーへ支払います。
立替額を2で掛けたのは、最後に2で割るためです。通常の支出は折版なので2で割って問題ありませんが、立替は全額
返還する必要があるため、あらかじめ倍の額で計上します。